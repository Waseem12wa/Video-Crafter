<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Video Editor - Highlight & Subtitle Tool</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}?v=27" />
</head>

<body>
  <div class="container">
    <header>
      <h1>üé¨ Video Editor</h1>
      <p>
        Upload a talking-head video, attach B-roll and music to specific
        segments of the script, and export a finished edit.
      </p>
      <button class="btn btn-secondary" id="open-clip-manager-btn" style="margin-top: 15px;">
        üé® Open Clip Manager
      </button>
    </header>

    <!-- Load Existing Project -->
    <section class="card" id="load-project-section">
      <h2>üìÇ Load Existing Project</h2>
      <p class="instruction">
        Load a project that was previously saved to S3 so you can continue
        editing from where you left off.
      </p>
      <button class="btn btn-primary" id="load-project-btn">
        üìÇ Load Project from S3
      </button>
      <div id="project-list-container" style="display: none; margin-top: 20px;">
        <h3>Available Projects</h3>
        <div id="project-list" style="
              max-height: 400px;
              overflow-y: auto;
              border: 1px solid #ddd;
              border-radius: 5px;
              padding: 10px;
            ">
          <!-- Filled by JS -->
        </div>
      </div>
    </section>

    <!-- Clip Manager Overlay -->
    <div id="clip-manager-overlay" class="clip-manager-overlay">
      <div class="clip-manager-header">
        <button id="back-clip-manager" class="btn btn-secondary" style="margin-right: 15px;"
          onclick="closeClipManager()">&larr; Back</button>
        <h2>üé® Asset Library</h2>
        <button id="close-clip-manager" class="clip-manager-close" onclick="closeClipManager()">&times;</button>
      </div>

      <div class="clip-manager-toolbar">
        <div class="clip-tabs">
          <button class="clip-tab-btn active" data-tab="video" id="tab-video">
            üìπ Video Clips
          </button>
          <button class="clip-tab-btn" data-tab="audio" id="tab-audio" style="display: none !important;">
            üéµ Audio Files
          </button>
        </div>

        <div class="clip-search-box">
          <span class="clip-search-icon">üîç</span>
          <input type="text" class="clip-search-input" id="clip-search-input" placeholder="Search assets..." />
        </div>

        <div class="asset-upload-area" style="margin:0; padding: 10px; border:none; background:transparent;">
          <input type="file" id="asset-upload-input" style="display:none;" accept="video/*,audio/*" multiple />
          <button class="btn btn-primary" id="asset-upload-btn-overlay">
            ‚¨ÜÔ∏è Upload New
          </button>
          <button class="btn btn-success" id="bulk-add-btn" style="display:none; margin-left:10px;">
            ‚ûï Add Selected to Timeline
          </button>
          <button class="btn btn-danger" id="bulk-delete-btn" style="display:none; margin-left:10px;">
            üóë Delete Selected
          </button>
          <span id="asset-upload-status" style="margin-left:10px; font-size:0.9em;"></span>
        </div>
      </div>

      <div class="clip-manager-content">
        <!-- Video Grid -->
        <div id="video-asset-list" class="asset-list-grid">
          <!-- Filled by JS -->
        </div>

        <!-- Audio Grid (Hidden by default) -->
        <div id="audio-asset-list" class="asset-list-grid" style="display:none;">
          <!-- Filled by JS -->
        </div>
      </div>
    </div>





    <!-- Batch Processing (Sequential) -->
    <section class="card" id="batch-processing-section">
      <h2>‚ö° Batch Processing (Sequential)</h2>
      <p class="instruction">
        Add multiple batches (main video + subtitle text + clip mapping) and
        process them one-by-one. Each batch will show a preview and download
        link when it finishes. Use <strong>Edit</strong> to open the full
        highlight + music editor below for that batch, then <strong>Save
          Batch</strong> to queue your changes.
      </p>

      <div class="batch-toolbar">
        <div class="batch-toolbar-left">
          <button class="btn btn-primary" id="batch-add-btn" type="button">
            ‚ûï Add Batch
          </button>
          <button class="btn btn-success" id="batch-start-btn" type="button" disabled>
            ‚ñ∂Ô∏è Start Processing
          </button>
          <button class="btn btn-secondary" id="batch-stop-btn" type="button" disabled>
            ‚èπ Stop Queue
          </button>
          <button class="btn btn-secondary" id="batch-clear-btn" type="button">
            üßπ Clear
          </button>
        </div>

        <div class="batch-toolbar-right">
          <label for="batch-aspect-ratio" class="batch-label">Aspect ratio</label>
          <select id="batch-aspect-ratio" class="custom-select">
            <option value="4:5" selected>4:5</option>
            <option value="9:16">9:16</option>
          </select>
        </div>
      </div>

      <div id="batch-editor-banner" class="batch-editor-banner" style="display: none;">
        <div class="batch-editor-banner-left">
          <div class="batch-editor-banner-title">
            Editing: <span id="batch-editor-batch-name"></span>
          </div>
          <div class="batch-editor-banner-subtitle" id="batch-editor-batch-meta"></div>
        </div>
        <div class="batch-editor-banner-actions">
          <button class="btn btn-success" id="batch-save-current-btn" type="button" disabled>
            üíæ Save Batch
          </button>
          <button class="btn btn-secondary" id="batch-exit-editor-btn" type="button">
            ‚Ü© Back to Batches
          </button>
        </div>
      </div>

      <div id="batch-list" class="batch-list"></div>

      <template id="batch-item-template">
        <div class="batch-item" data-batch-id="">
          <div class="batch-item-header">
            <div class="batch-item-title">
              <div class="batch-item-name">Batch</div>
              <span class="batch-badge batch-badge-needs">Needs files</span>
            </div>
            <div class="batch-item-actions">
              <button class="btn btn-primary batch-edit-btn" type="button"
                title="Edit this batch using the editor below">
                Edit
              </button>
              <button class="btn btn-success batch-process-btn" type="button" title="Process just this batch" disabled>
                Process
              </button>
              <button class="btn btn-danger batch-remove-btn" type="button" title="Remove batch">
                Remove
              </button>
            </div>
          </div>

          <div class="batch-item-body">
            <div class="batch-file-grid">
              <div class="batch-file-field">
                <label class="batch-field-label">üìπ Main video (.mp4)</label>
                <input type="file" class="batch-video-input" accept="video/*" />
                <div class="batch-file-name batch-video-name"></div>
              </div>

              <div class="batch-file-field">
                <label class="batch-field-label">üìù Subtitle text (.txt)</label>
                <input type="file" class="batch-subtitle-input" accept=".txt,text/plain" />
                <div class="batch-file-name batch-subtitle-name"></div>
              </div>

              <div class="batch-file-field">
                <label class="batch-field-label">üß† Clip mapping (.txt / .json)</label>
                <input type="file" class="batch-mapping-input" accept=".txt,.json,application/json,text/plain" />
                <div class="batch-file-name batch-mapping-name"></div>
                <div class="batch-field-help">
                  TXT format: <code>"Some phrase" -&gt; 4</code> (or use
                  <code>‚Üí</code>). JSON format:
                  <code>[{ "segment": "...", "clip": 4 }]</code>
                </div>
              </div>
            </div>

            <div class="batch-log" aria-live="polite"></div>

            <div class="batch-result" style="display: none;">
              <div class="batch-result-preview">
                <video class="batch-preview" controls preload="metadata">
                  Your browser does not support the video tag.
                </video>
              </div>
              <div class="batch-result-actions">
                <a class="btn btn-success batch-download-btn" href="#" target="_self" rel="noopener">‚¨áÔ∏è Download</a>
                <a class="btn btn-secondary batch-s3-btn" href="#" target="_blank" rel="noopener"
                  style="display: none;">Open on S3</a>
              </div>
            </div>
          </div>
        </div>
      </template>
    </section>

    <!-- Step 1: Upload Main Video + Script + Mapping -->
    <section class="card" id="upload-section">
      <h2>Step 1: Upload Video & Script</h2>

      <!-- Video Upload -->
      <div class="upload-area">
        <h3>üìπ Main Video (or üéµ Audio)</h3>
        <input type="file" id="main-video-input" accept="video/*,audio/*" style="display: none;" />
        <button class="btn btn-primary" onclick="document.getElementById('main-video-input').click()">
          Choose Video File
        </button>
        <p id="video-filename" class="filename-display"></p>
      </div>

      <!-- Script Upload -->
      <div class="upload-area" style="margin-top: 20px;">
        <h3>üìù Script (.txt)</h3>
        <input type="file" id="transcript-file-input" accept=".txt" style="display: none;" />
        <button class="btn btn-primary" onclick="document.getElementById('transcript-file-input').click()">
          Choose Script File
        </button>
        <p id="transcript-filename" class="filename-display"></p>
        <p class="option-description">
          Upload a plain text version of the script. The backend will split it
          into words and subtitle blocks.
        </p>
      </div>

      <!-- Zip Auto Mapping Upload (optional) -->
      <div class="upload-area" style="margin-top: 20px;">
        <h3>üß† Auto Highlight Mapping (Upload .zip)</h3>
        <input type="file" id="zip-mapping-input" accept=".zip" style="display: none;" />
        <button class="btn btn-primary" onclick="document.getElementById('zip-mapping-input').click()">
          Choose Clip Zip File
        </button>
        <p id="zip-mapping-filename" class="filename-display"></p>
        <p class="option-description">
          Upload a ZIP file containing clips. Filenames will be used as the search text.
          (e.g., <code>i_love_tea.mp4</code> ‚Üí highlights "i love tea").
          "find the clip" will be ignored.
        </p>
      </div>

      <button class="btn btn-success btn-large" id="upload-btn" disabled>
        ‚¨ÜÔ∏è Upload & Continue
      </button>

      <div id="upload-progress" class="progress-bar" style="display: none; margin-top: 15px;">
        <div class="progress-fill"></div>
        <span class="progress-text">Uploading & processing‚Ä¶</span>
      </div>
    </section>

    <!-- Step 2: Transcript Preview -->
    <section class="card" id="transcript-preview-section" style="display: none !important;">
      <h2>Step 2: Transcript Preview</h2>
      <p class="instruction">
        Preview the script split into subtitle lines. Words that have
        highlights or music attached will be visually marked.
      </p>
      <div id="transcript-preview" class="transcript-box"></div>
    </section>

    <!-- Step 3: Select Text for B-roll Highlights -->
    <section class="card" id="selection-section" style="display: none;">
      <h2>Step 3: Select Text for B-roll</h2>
      <p class="instruction">
        Click and drag across words to select a phrase. Then attach a B-roll
        clip to that phrase.
      </p>

      <div id="transcript-display" class="transcript-box"></div>

      <div id="selection-controls" style="display: none; margin-top: 20px;">
        <h3>
          Selected Text:
          "<span id="selected-text" class="highlight-phrase"></span>"
        </h3>

        <div class="highlight-form">
          <div class="form-group">
            <label>Upload a new clip for this highlight:</label>
            <div class="file-input-wrapper">
              <input type="file" id="clip-input" accept="video/*" class="hidden-file-input" />
              <button class="btn btn-primary" onclick="document.getElementById('clip-input').click()">
                üìÅ Choose Clip File
              </button>
              <span id="clip-filename" class="file-name-display" style="margin-left: 8px;"></span>
            </div>
            <button class="btn btn-secondary" id="upload-clip-btn" style="margin-top: 8px;">
              ‚¨ÜÔ∏è Upload Clip
            </button>
          </div>

          <div class="form-group">
            <label>Or select an existing clip:</label>
            <select id="existing-clips" class="custom-select">
              <option value="">-- Select existing clip --</option>
            </select>
          </div>

          <div class="form-actions">
            <button class="btn btn-success" id="add-highlight-btn">
              ‚ûï Add Highlight
            </button>
            <button class="btn btn-secondary" id="cancel-selection-btn">
              ‚ùå Cancel
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Step 4: Review B-roll Highlights -->
    <section class="card" id="highlights-section" style="display: none;">
      <h2>Step 4: Review B-roll Highlights</h2>
      <p class="instruction">
        These entries represent where B-roll clips will appear over the main
        video.
      </p>
      <div id="highlights-list"></div>
    </section>

    <!-- Step 5: Select Text for Music/Audio -->
    <section class="card" id="music-selection-section" style="display: none !important;">
      <h2>Step 5: Select Text for Music/Audio</h2>
      <p class="instruction">
        Use this section to attach background music or audio-only tracks to
        specific script segments.
      </p>

      <div id="music-transcript-display" class="transcript-box"></div>

      <div id="music-selection-controls" style="display: none; margin-top: 20px;">
        <h3>
          Selected Text:
          "<span id="music-selected-text" class="highlight-phrase"></span>"
        </h3>

        <div class="highlight-form">
          <div class="form-group">
            <label>Upload a new audio file:</label>
            <div class="file-input-wrapper">
              <input type="file" id="music-input" accept="audio/*" class="hidden-file-input" />
              <button class="btn btn-primary" onclick="document.getElementById('music-input').click()">
                üìÅ Choose Audio File
              </button>
              <span id="music-filename" class="file-name-display" style="margin-left: 8px;"></span>
            </div>
            <button class="btn btn-secondary" id="upload-music-btn" style="margin-top: 8px;">
              ‚¨ÜÔ∏è Upload Audio
            </button>
          </div>

          <div class="form-group">
            <label>Or select existing audio:</label>
            <select id="existing-music-select" class="custom-select">
              <option value="">-- Select existing audio --</option>
            </select>
          </div>

          <div class="form-group">
            <label for="music-volume">Audio Volume:</label>
            <input type="range" id="music-volume" min="0" max="2" step="0.1" value="1.0" />
            <span id="music-volume-display">1.0</span>
          </div>

          <div class="form-actions">
            <button class="btn btn-success" id="add-music-btn">
              ‚ûï Add Music Highlight
            </button>
            <button class="btn btn-secondary" id="cancel-music-selection-btn">
              ‚ùå Cancel
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Step 6: Review Music Highlights -->
    <section class="card" id="music-highlights-section" style="display: none !important;">
      <h2>Step 6: Review Music Highlights</h2>
      <p class="instruction">
        These entries represent where music/audio will play in the final
        timeline.
      </p>
      <div id="music-highlights-list"></div>
    </section>

    <!-- Step 7: Process Video + Save Project -->
    <section class="card" id="process-section" style="display: none;">
      <h2>Step 7: Process Your Video</h2>
      <p class="instruction">
        Choose the final aspect ratio and process the video. You can also save
        this project configuration to S3.
      </p>

      <div style="
            margin: 20px 0;
            padding: 15px;
            background: #f0f8ff;
            border-radius: 5px;
            border: 1px solid #b0d4f1;
          ">
        <h3 style="margin-bottom: 10px;">üíæ Save Project to S3</h3>
        <p style="margin-bottom: 10px; font-size: 0.9em; color: #555;">
          Save your current video, transcript, highlights, and music
          configuration so you can reload it later or share with your team.
        </p>
        <div style="
              display: flex;
              flex-wrap: wrap;
              gap: 10px;
              align-items: center;
            ">
          <label for="project-name-input" style="font-weight: 500;">Project Name (optional):</label>
          <input type="text" id="project-name-input" placeholder="e.g., Baby Belt UGC V1" style="
                flex: 1;
                min-width: 200px;
                padding: 6px 8px;
                border-radius: 4px;
                border: 1px solid #ccc;
              " />
          <button class="btn btn-secondary" id="save-project-btn">
            üíæ Save Project
          </button>
        </div>
        <div id="save-project-status" style="margin-top: 8px; display: none;"></div>
      </div>

      <div class="form-group">
        <label for="aspect-ratio-select">üìê Aspect Ratio:</label>
        <select id="aspect-ratio-select" class="custom-select">
          <option value="4:5">4:5 (Portrait ‚Äì IG feed)</option>
          <option value="9:16">9:16 (Vertical ‚Äì Reels/Shorts/TikTok)</option>
          <option value="1:1">1:1 (Square)</option>
          <option value="16:9">16:9 (Landscape ‚Äì YouTube)</option>
        </select>
      </div>

      <div class="form-group" style="margin-top: 20px;">
        <label>üé® Subtitle Design:</label>
        <p style="font-size: 0.85em; color: #666; margin: 5px 0 15px 0;">
          Choose a subtitle style for your video. Each design has a unique look and feel.
        </p>
        <div id="subtitle-design-selector" style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
              gap: 15px;
              margin-top: 10px;
            ">
          <!-- Design 1 -->
          <div class="subtitle-design-option selected" data-design="1" style="
                cursor: pointer;
                border: 2px solid #4CAF50;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_1.png') }}" alt="Design 1 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 1
            </div>
            <div class="design-badge" style="
                  display: inline-block;
                  background: #4CAF50;
                  color: white;
                  padding: 2px 8px;
                  border-radius: 12px;
                  font-size: 0.75em;
                  margin-top: 5px;
                ">
              Default
            </div>
          </div>

          <!-- Design 2 -->
          <div class="subtitle-design-option" data-design="2" style="
                cursor: pointer;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_2.png') }}" alt="Design 2 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 2
            </div>
          </div>

          <!-- Design 3 -->
          <div class="subtitle-design-option" data-design="3" style="
                cursor: pointer;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_3.png') }}" alt="Design 3 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 3
            </div>
          </div>

          <!-- Design 4 -->
          <div class="subtitle-design-option" data-design="4" style="
                cursor: pointer;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_4.png') }}" alt="Design 4 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 4
            </div>
          </div>

          <!-- Design 5 -->
          <div class="subtitle-design-option" data-design="5" style="
                cursor: pointer;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_5.png') }}" alt="Design 5 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 5
            </div>
          </div>

          <!-- Design 6 -->
          <div class="subtitle-design-option" data-design="6" style="
                cursor: pointer;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                text-align: center;
                transition: all 0.3s;
                background: #f9f9f9;
              ">
            <div class="design-preview" style="
                  width: 100%;
                  height: 80px;
                  border-radius: 4px;
                  margin-bottom: 8px;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                ">
              <img src="{{ url_for('static', filename='images/subtitle_design_6.png') }}" alt="Design 6 Preview"
                style="width: 100%; height: 100%; object-fit: contain;">
            </div>
            <div class="design-name" style="font-weight: 600; font-size: 0.9em;">
              Subtitle 6
            </div>
          </div>
        </div>
      </div>



      <div class="form-group" style="margin-bottom: 20px;">
        <div style="display: flex; align-items: center;">
          <input type="checkbox" id="render-subtitles-checkbox" checked style="width: auto; margin-right: 10px;">
          <label for="render-subtitles-checkbox" style="margin-bottom: 0;">Render Subtitles (Overlay)</label>
        </div>
        <p style="font-size: 0.8em; color: #666; margin-top: 5px; margin-left: 25px;">Uncheck this to burn highlights
          only, without text overlays.</p>

        <div style="display: flex; align-items: center; margin-top: 15px;">
          <input type="checkbox" id="rip-and-run-checkbox" style="width: auto; margin-right: 10px;">
          <label for="rip-and-run-checkbox" style="margin-bottom: 0;">Rip & Run</label>
        </div>
        <p style="font-size: 0.8em; color: #666; margin-top: 5px; margin-left: 25px;">Only show subtitles when a B-roll
          clip is visible.</p>
      </div>

      <button class="btn btn-success btn-large" id="process-btn">
        ‚öôÔ∏è Process Video
      </button>

      <div id="process-progress" class="progress-bar" style="display: none; margin-top: 15px;">
        <div class="progress-fill"></div>
        <span class="progress-text">Rendering video‚Ä¶</span>
      </div>
    </section>

    <!-- Step 8: Result / Download -->
    <section class="card" id="result-section" style="display: none;">
      <h2>‚úÖ Video Processed</h2>
      <p id="result-message">
        Your video has been processed. You can preview and download it below.
      </p>

      <div id="video-preview-container" style="margin: 20px 0; text-align: center;">
        <h3>üì∫ Preview</h3>
        <video id="video-preview" controls style="
              max-width: 100%;
              border-radius: 8px;
              box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            ">
          Your browser does not support the video tag.
        </video>
      </div>

      <div style="text-align: center;">
        <a id="download-btn" class="btn btn-success btn-large" href="javascript:void(0);">
          ‚¨áÔ∏è Download Processed Video
        </a>
        <button class="btn btn-primary btn-large" id="go-back-btn" style="margin-left: 10px;">
          üîÑ Go Back & Edit
        </button>
      </div>
    </section>
  </div>

  <!-- Modal for attaching a clip (kept for future use / UX) -->
  <div id="video-upload-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Attach a Clip to Selected Text</h3>
        <span class="modal-close" id="close-modal-btn">&times;</span>
      </div>
      <div class="modal-body">
        <p class="modal-selected-text">
          Selected text:
          "<span id="modal-selected-text" class="highlight-phrase"></span>"
        </p>
        <div class="modal-upload-area">
          <input type="file" id="modal-video-input" accept="video/*" class="hidden-file-input" />
          <button class="btn btn-primary" onclick="document.getElementById('modal-video-input').click()">
            üìÅ Choose File
          </button>
          <span id="modal-video-filename" class="file-name-display" style="margin-left: 8px;"></span>
        </div>
        <div class="modal-actions" style="margin-top: 15px;">
          <button class="btn btn-success" id="modal-upload-btn">
            ‚¨ÜÔ∏è Upload & Attach
          </button>
          <button class="btn btn-secondary" id="modal-cancel-btn">
            ‚ùå Cancel
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="clip-preview-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 800px;">
      <div class="modal-header">
        <h3>üìπ Clip Preview</h3>
        <span class="modal-close" onclick="closePreviewModal()">&times;</span>
      </div>
      <div class="modal-body" style="text-align: center; background: black;">
        <video id="preview-player" controls style="max-width: 100%; max-height: 60vh;">
          Your browser does not support the video tag.
        </video>
        <p id="preview-filename-display" style="color: white; margin-top: 10px;"></p>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='script.js') }}?v=29"></script>
  <script src="{{ url_for('static', filename='batch.js') }}"></script>
</body>

</html>